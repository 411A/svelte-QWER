.prose {
  --at-apply: 'px[1.5rem]';
  h1:not(.code-title),
  h2:not(.code-title),
  h3:not(.code-title),
  h4:not(.code-title),
  h5:not(.code-title) {
    --at-apply: 'after:(content-[#] px2 op10 hover:op100)';
    a {
      --at-apply: 'no-underline';
    }
  }
}

body {
  .code-block {
    .code-line {
      &.line-highlight {
        background-color: rgba(55, 65, 81, 0.2);

        .line-number,
        .no-line-number {
          border-left-color: rgb(59, 130, 246);
        }
      }

      &.line-addition {
        background-color: rgba(16, 185, 129, 0.3);
      }

      &.line-subtraction {
        background-color: rgba(239, 68, 68, 0.3);
      }
    }
  }
}

body.dark {
  .code-block {
    .code-line {
      &.line-highlight {
        background-color: rgba(55, 65, 81, 0.5);

        .line-number,
        .no-line-number {
          border-left-color: rgb(59, 130, 246);
        }
      }

      &.line-addition {
        background-color: rgba(16, 185, 129, 0.3);
      }

      &.line-subtraction {
        background-color: rgba(239, 68, 68, 0.3);
      }
    }
  }
}

.code-block {
  --at-apply: 'relative my4 mx-[-1.5rem] flex flex-col border-y-1 md:(rounded-lg border-1 mx0) border-black/[0.5] dark:border-white/[0.5] shadow-2xl';

  h2 {
    --at-apply: '!text-xl !m0';
  }

  code {
    --at-apply: 'flex flex-col py4';
  }

  .code-title {
    --at-apply: 'text-md font-semibold pl4 py2 border-b-1 border-black/[0.5] dark:border-white/[0.5]';
  }

  .code-line {
    --at-apply: 'flex leading-[1.5rem] hover:(dark:!bg-white/[0.25] !bg-black/[0.25])';

    .code-linenotation {
      --at-apply: 'flex';
    }

    &.line-highlight {
      .line-number,
      .no-line-number {
        border-left-width: 4px;
      }
    }
    .code-content {
      --at-apply: 'flex-1';
    }
  }

  .line-number {
    --at-apply: 'px2 h-full w7 inline-block border-l-4 border-l-transparent border-r-1 border-r-black dark:border-r-white select-none';
  }
  .no-line-number {
    --at-apply: 'px2 h-full w2 inline-block select-none';
  }

  .line-diff {
    --at-apply: 'px2 h-full w6 inline-block select-none';
  }

  .no-line-diff {
    --at-apply: 'px2 h-full w2 inline-block select-none';
  }
}

.inline-code-block {
  --at-apply: 'rounded-lg bg-gray/[0.5] mx-1 px3 py1 hover:bg-black/[0.5]';
}
